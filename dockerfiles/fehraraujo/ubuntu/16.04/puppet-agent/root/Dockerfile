# Dockerfile generated by tp::dockerize { 'puppet-agent': }
FROM ubuntu:16.04

RUN apt-get update && apt-get install -y --force-yes --no-install-recommends wget
RUN echo 'deb http://apt.puppetlabs.com xenial PC1' > /etc/apt/sources.list.d/puppet-agent.list
RUN wget -O - http://apt.puppetlabs.com/pubkey.gpg | apt-key add -
RUN apt-get update && \
apt-get install -y --force-yes --no-install-recommends puppet-agent && \
apt-get install -y --force-yes --no-install-recommends supervisor && \
rm -rf /var/lib/apt/lists/*

RUN echo -e "[supervisord]\nnodaemon=true\n\n[program:puppet]\ncommand=puppet   " >> /etc/supervisor/conf.d/puppet-agent.conf


VOLUME  /var/log/puppetlabs/puppet 
COPY root /


CMD [ "/usr/bin/supervisord" , "-n" , "-c" , "/etc/supervisor/supervisord.conf" ]

